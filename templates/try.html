<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Echo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+Knujsl7/1L_dstPt3HV5HzF6Gvk/e3s4Wz6iJgD/+ub2oU" crossorigin="anonymous">
    <!-- Your additional styles -->
    <style>
      /* Your custom styles */
/* Common styles for body and html */
body, html {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: Arial, sans-serif; /* Use a sans-serif font */
    overflow: auto; /* Re-enable scrolling for smaller devices */
}

/* Media query for screens smaller than 768px (tablets and mobiles) */
@media (max-width: 768px) {
    body, html {
        background-size: auto; /* Adjust background size for smaller screens */
        background-position: top; /* Adjust background position for smaller screens */
    }
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
    body, html {
        background-size: auto; /* Further adjust background size for mobiles if needed */
        background-position: top; /* Further adjust background position for mobiles if needed */
    }
}
/* Common styles for #background-image-container */
#background-image-container {
    position: absolute; /* Make it cover the entire screen */
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url('https://ichef.bbci.co.uk/news/1024/cpsprodpb/9B52/production/_120726793_astromovingaroundhome.jpg.webp');
    background-size: cover;
    background-repeat: no-repeat;
    filter: blur(4px); /* Adjust blur intensity */
    -webkit-filter: blur(10px);
    z-index: -1; /* Place behind content */
}

/* Media query for screens smaller than 768px (tablets and mobiles) */
@media (max-width: 768px) {
    #background-image-container {
        filter: blur(3px); /* Adjust blur intensity for smaller screens */
        -webkit-filter: blur(2px);
    }
}

/* Media query for screens smaller than 1024px (laptops) */
@media (max-width: 1024px) {
    #background-image-container {
        filter: blur(5px); /* Adjust blur intensity for laptops */
        -webkit-filter: blur(3px);
    }
}

/* Media query for screens smaller than 768px (tablets) */
@media (max-width: 768px) {
    #background-image-container {
        filter: blur(6px); /* Adjust blur intensity for tablets */
        -webkit-filter: blur(4px);
    }
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
    #background-image-container {
        filter: blur(8px); /* Adjust blur intensity for mobiles */
        -webkit-filter: blur(5px);
    }
}

/* CSS for chatbot container */
.chatbot-container {
  display: flex;
  flex-direction: column;
  height: 70vh;
  width: 60vw; /* Default width for larger screens */
  position: fixed;
  background-color: #a2e3da98; /* White background */
  border: 1px solid #dc9494; /* Light gray border */
  border-radius: 10px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* Apply same styles to all child elements */
.chatbot-container * {
  box-sizing: border-box;
}

/* Media query for screens smaller than 1024px (laptops) */
@media (max-width: 1024px) {
  .chatbot-container {
    width: 70vw; /* Adjust width for laptops */
  }
}

/* Media query for screens smaller than 768px (tablets) */
@media (max-width: 768px) {
  .chatbot-container {
    width: 80vw; /* Adjust width for tablets */
  }
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
  .chatbot-container {
    
    width: 90vw; /* Adjust width for mobiles */
  }
}
/* Style for the header */
.chatbot-header {
  background-color: #80d284d5; /* Light gray background */
  border-bottom: 1px solid #ccc; /* Light gray border */
  color: #0d0806e7; /* Dark text color */
  padding: 06px;
  text-align: center;
  font-weight: bold;
  font-style: italic;
  font-size: large;
}

/* Style for the chat messages area */
.chatbot-messages {
  flex: 1; /* Take remaining space */
  padding: 15px;
  overflow-y: auto; /* Enable scrolling if content overflows */
  font-family: Arial, sans-serif; /* Use a sans-serif font */
}

/* Media query for screens smaller than 768px (tablets and mobiles) */
@media (max-width: 768px) {
  /* Adjust styles for smaller screens */
  .chatbot-header {
    font-size: 16px; /* Example adjustment */
    padding: 8px; /* Example adjustment */
  }
  
  .chatbot-messages {
    font-size: 14px; /* Example adjustment */
    padding: 10px; /* Example adjustment */
  }
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
  /* Further adjustments for mobile devices */
  .chatbot-header {
    font-size: 14px; /* Example adjustment */
    padding: 6px; /* Example adjustment */
  }
  
  .chatbot-messages {
    font-size: 12px; /* Example adjustment */
    padding: 8px; /* Example adjustment */
  }
}

/* Style for the input field and send button container */
.input-container {
  display: flex;
  align-items: 20px;
  padding: 09px;
}


/* Style for the input field */
.chatbot-input {
  flex: 1; /* Take remaining space */
  padding: 5px; /* Adjusted padding */
  border: 5px solid #ccc; /* Light gray border */
  border-radius: 10px;
  margin-right: 10px; /* Adjusted margin */
  margin-left: 05px;
  font-size: 16px;
  box-sizing: border-box;
  width: 100%; /* Adjust the width as needed */
  height: 40px; /* Adjust the height as needed */
}

/* Style for the button */
/* Adjust button padding to accommodate the icon */
.chatbot-btn {
  padding: 8px 15px;
  background-color: #41cca0;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s;
}
.chatbot-input::placeholder { 
  color: #999;  
  font-style: italic;
  padding-left: 50px; /* Indent from the left by 10px */
  padding-top: 8px;
  padding-top: 1px;
} 

/* Media query for screens smaller than 768px (tablets and mobiles) */
@media (max-width: 768px) {
  /* Adjust styles for smaller screens */
  .input-container {
    padding: 8px 12px; /* Example adjustment */
  }
  
  .chatbot-input {
    font-size: 12px; /* Example adjustment */
    padding: 4px; /* Example adjustment */
    margin-right: 8px; /* Example adjustment */
  }
  
  .chatbot-btn {
    padding: 6px 12px; /* Example adjustment */
    font-size: 12px; /* Example adjustment */
  }
 
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
  /* Further adjustments for mobile devices */
  .input-container {
    padding: 10px 10px; /* Example adjustment */
  }
  
  .chatbot-input {
    font-size: 10px; /* Example adjustment */
    padding: 5px; /* Example adjustment */
    margin-right: 03px; /* Example adjustment */
    display: flex;
    border: #333 solid 2px;
  
  }
  .chatbot-input::placeholder { 
  color: #999;  
  font-style: italic;
  padding-left: 30px; /* Indent from the left by 10px */
  padding-top: 5px;
} 

  .chatbot-btn {
    padding: 4px 10px; /* Example adjustment */
    font-size: 10px; /* Example adjustment */
  }
  

}

/* Style for user's message */
.userclass {
  text-align: right;
  margin: 10px;
  padding: 10px;
  background-color: #88b7b8; /* Blue background */
  color: #fff; /* White text color */
  border-radius: 10px;
}

/* Style for bot's message */
.botclass {
  text-align: left;
  margin: 10px;
  padding: 10px;
  background-color: #98bfe6; /* Light blue background */
  color: #333; /* Dark text color */
  border-radius: 10px;
}

/* Media query for screens smaller than 768px (tablets and mobiles) */
@media (max-width: 768px) {
  /* Adjust styles for smaller screens */
  .userclass,
  .botclass {
    font-size: 14px; /* Example adjustment */
    margin: 8px; /* Example adjustment */
    padding: 8px; /* Example adjustment */
    border-radius: 8px; /* Example adjustment */
  }
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
  /* Further adjustments for mobile devices */
  .userclass,
  .botclass {
    font-size: 12px; /* Example adjustment */
    margin: 6px; /* Example adjustment */
    padding: 6px; /* Example adjustment */
    border-radius: 6px; /* Example adjustment */
  }
}
/* Style for chatbot header links */
.chatbot-header a {
  margin-left: 2vw; /* Adjusted margin for responsiveness */
}

/* Style for navbar links */
#navbar #nav a {
  position: sticky; /* Sticky positioning */
  margin-left: 5vw; /* Adjusted margin for responsiveness */
  margin-top: 3vh; /* Adjusted margin for responsiveness */
  font-size: 6vw; /* Adjusted font size for responsiveness */
  z-index: 2;
}

/* Style for weather container */
/* Style for weather container */
   /* Style for weather icon */
#weather-icon {
    width: 80px; /* Adjusted width */
    height: 80px; /* Adjusted height */
    margin-bottom: 10px;
}
/* Style for weather container */
.weather-container {
    position: fixed; /* Use fixed positioning */
    top: 0; /* Align to the top */
    right: 0; /* Align to the right */
    background-color: #ffffff00;
    border-radius: 5px;
    padding: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.);
    font-family: Arial, sans-serif;
    display: flex; /* Use flexbox */
    align-items: center; /* Align items vertically */
}

/* Style for weather icon */
#weather-icon {
    width: 100px;
    height: 100px;
    margin-right: 10px; /* Add margin to separate icon from weather info */
}

/* Style for weather information */
#weather-info {
    font-size: 16px;
    line-height: 1.5;
    margin-left: auto; /* Push weather info to the right */
}

/* Media query for screens smaller than 768px (tablets and mobiles) */
@media (max-width: 768px) {
    /* Adjust styles for smaller screens */
    .weather-container {
        top: 10px;
        right: 10px;
        padding: 8px;
        flex-direction: column; /* Stack icon and info vertically on smaller screens */
        align-items: flex-start; /* Align items to the start */
    }

    #weather-icon {
        width: 80px;
        height: 80px;
        margin-right: 0; /* Remove margin for smaller screens */
        margin-bottom: 10px; /* Add margin below icon */
    }

    #weather-info {
        font-size: 14px;
        margin-left: 0; /* Reset margin for smaller screens */
    }
}

/* Media query for screens smaller than 425px (mobiles) */
@media (max-width: 425px) {
    /* Further adjustments for mobile devices */
    .weather-container {
        top: 1px;
        left: 98px;
        height: 58px;
        width: 70px;
        right: 2px;
        padding: 6px;
        /* border: 2px solid black; */
    }

    #weather-icon {
        
        width: 85px;
        height: 85px;
        margin-bottom: 5px; /* Adjust margin for smaller screens */
    }

    #weather-info {
        width: 120px;
        font-size: 12px;
        margin-left: 80px;
        right: 20px;
        /* border: 2px solid black; */
        margin-top: -95px;
        
    }
}
    </style>
</head>
<body>
     <div id="background-image-container"></div>
    </div> 
</body>
<body>
 <!-- Weather container -->
 <div class="weather-container">
  <!-- Weather icon with link -->
  <div>
      <a href="https://weather-forecasting-zbiz.onrender.com/">
          <img id="weather-icon" src="http://openweathermap.org/img/wn/01d.png" alt="Weather Icon" width="120" height="120">
      </a>
  </div>
  <!-- Weather information -->
  <div id="weather-info"></div>
</div>
</body>
<body>
      <!-- Chatbot container -->
<div class="chatbot-container">
  <marquee class="marq" direction="left" loop="">
    <div class="gek1">
         WEL-COME BUDDY 😊
        How Can I Assist You ?
    </div>
</marquee>  
  <div class="chatbot-header">EchoBot</div>

  <div class="chatbot-messages" id="chatbot-messages">
    <!-- Bot's initial greeting message -->
    <div class="botclass">Welcome! How can I assist you?</div>
  </div>
  <div class="input-container">
    <textarea class="form-control chatbot-input" aria-label="Chat-input" id="usermsg" placeholder="Enter your message" onkeypress="handleKeyPress(event)"></textarea>
    <button class="btn btn-primary chatbot-btn" onclick="sendMessage()" type="button" id="sendbutton" aria-label="Send message">
        <i class="fas fa-paper-plane"></i> <!-- Font Awesome icon for send -->
    </button>
    <div id="error-msg" class="error-msg"></div> <!-- Error message container -->
</div> 

</div>
</div>
            </body>
             </div>
        </div>
    </div>

    <!-- Bootstrap JavaScript libraries -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz4fnFO9gybB5IXNxFwWQfE7u8Lj+XJHAxKlXiG/8rsrtpb6PEdzD828Ii" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <!-- Your additional scripts -->
    <script>
   function sendMessage(userMessage) {
      if (!userMessage.trim()) return;

      var chatMessages = document.getElementById("chatbot-messages");

      // Save user's message in local storage
      saveUserMessage(userMessage);

      // Display user's message in the chat
      var userMessageElement = document.createElement("div");
      userMessageElement.classList.add("userclass");
      userMessageElement.textContent = userMessage;
      chatMessages.appendChild(userMessageElement);

      // Display typing indicator while waiting for the bot's response
      var typingIndicator = document.createElement("div");
      typingIndicator.classList.add("typing-indicator");
      typingIndicator.innerText = "Typing...";
      chatMessages.appendChild(typingIndicator);

      // Send user's message to the server
      fetch('/messager', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ message: userMessage })
      })
      .then(response => response.text())
      .then(botResponse => {
        // Remove typing indicator
        chatMessages.removeChild(typingIndicator);

        // Display bot's response in the chat
        var botMessageElement = document.createElement("div");
        botMessageElement.classList.add("botclass");
        botMessageElement.textContent = botResponse;
        chatMessages.appendChild(botMessageElement);

        // Scroll to the bottom of the chat window
        chatMessages.scrollTop = chatMessages.scrollHeight;
      })
      .catch(error => {
        console.error('Error sending message:', error);
        // Display error message in the chat
        var errorMessageElement = document.createElement("div");
        errorMessageElement.classList.add("botclass");
        errorMessageElement.textContent = "Sorry, something went wrong. Please try again later.";
        chatMessages.appendChild(errorMessageElement);
      });

      // Clear the input field after sending the message
      document.getElementById("usermsg").value = '';
    }

    function saveUserMessage(message) {
      if (typeof(Storage) !== "undefined") {
        try {
          localStorage.setItem("user_message", message);
        } catch (error) {
          console.error("Error saving message to local storage:", error);
          // Handle the error here, potentially display a message to the user
        }
      } else {
        console.log("Local storage is not supported by this browser.");
      }
    }

    function getUserMessage() {
      var message = localStorage.getItem("user_message");
      if (message !== null) {
        document.getElementById("usermsg").value = message;
        localStorage.removeItem("user_message");
      }
    }

    window.onload = getUserMessage;

    document.getElementById("usermsg").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        var userMessage = document.getElementById("usermsg").value.trim();
        sendMessage(userMessage);
      }
    });
      async function fetchWeatherByLocation() {
          const apiKey = 'c9c3f289f9a98421ddf3e808330ceb3c'; // Replace with your OpenWeatherMap API key 
  
          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(success, error);
          } else {
              document.getElementById("weather-info").innerHTML = "Geolocation is not supported by this browser.";
          }
  
          async function success(position) {
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;
              const apiUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`;
              await fetchWeather(apiUrl);
          }
  
          function error() {
              document.getElementById("weather-info").innerHTML = "Unable to retrieve your location.";
          }
  
          async function fetchWeather(apiUrl) {
              try {
                  const response = await fetch(apiUrl);
                  if (!response.ok) {
                      throw new Error('Network response was not ok');
                  }
                  const data = await response.json();
                  displayWeather(data);
              } catch (error) {
                  console.error('Error fetching weather data:', error);
                  document.getElementById("weather-info").innerHTML = 'Error fetching weather data. Please try again later.';
              }
          }
  
          function displayWeather(data) {
              const description = data.weather[0].description;
              const temperature = data.main.temp;
              const cityName = data.name;
              const country = data.sys.country;
              const iconCode = data.weather[0].icon;
              const iconUrl = `http://openweathermap.org/img/wn/${iconCode}.png`;
  
              document.getElementById("weather-icon").src = iconUrl; // Update icon
              document.getElementById("weather-info").innerHTML = `
                  City: ${cityName}, Country: ${country}<br>
                  Weather: ${description}<br>
                  Temperature: ${temperature}°C
              `;
          }
      }
  
      // Initial Fetch (call on page load)
      fetchWeatherByLocation();
  </script>
  
  

